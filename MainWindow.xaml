<mah:MetroWindow
    x:Class="SilentInstaller.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:av="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:controls="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
    xmlns:local="clr-namespace:SilentInstaller"
    xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="Silent Installer"
    Width="800"
    Height="500"
    Padding="15px"
    AllowsTransparency="True"
    BorderThickness="0"
    Foreground="Transparent"
    Icon="/data/fstlogo.jpg"
    NonActiveBorderBrush="#00808080"
    NonActiveWindowTitleBrush="#00808080"
    ResizeMode="NoResize"
    ShowTitleBar="False"
    WindowButtonCommandsOverlayBehavior="Never"
    WindowStyle="None"
    mc:Ignorable="av">

    <mah:MetroWindow.Resources>

        <!--  Button Template for No MouseOver Effect  -->
        <ControlTemplate x:Key="NoMouseOverButtonTemplate" TargetType="{x:Type Button}">
            <Border
                Background="{TemplateBinding Background}"
                BorderBrush="{TemplateBinding BorderBrush}"
                BorderThickness="{TemplateBinding BorderThickness}">
                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="{x:Static SystemColors.ControlLightBrush}" />
                    <Setter Property="Foreground" Value="{x:Static SystemColors.GrayTextBrush}" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </mah:MetroWindow.Resources>

    <Grid>
        <Grid>
            <Grid.Background>
                <ImageBrush ImageSource="/data/senomy.png" Stretch="UniformToFill" />
            </Grid.Background>

            <Grid.RowDefinitions>
                <RowDefinition Height="40px" />
                <RowDefinition />
            </Grid.RowDefinitions>
            <Border
                Grid.RowSpan="2"
                Background="Transparent"
                BorderBrush="Gray"
                BorderThickness="2" />
            <!--  Custom Title Bar  -->
            <Grid
                Height="40"
                VerticalAlignment="Top"
                MouseDown="MoveWindow">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="4*" />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <TextBlock
                    Grid.Column="0"
                    Padding="15,5,15,5"
                    VerticalAlignment="Center"
                    FontSize="16"
                    Foreground="White"
                    Text="Silent Installer" />
                <Button
                    Grid.Column="1"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Background="{x:Null}"
                    BorderBrush="Transparent"
                    BorderThickness="0"
                    Content="🛈"
                    FontSize="25"
                    FontWeight="ExtraLight"
                    Foreground="White"
                    Template="{StaticResource NoMouseOverButtonTemplate}">
                    <Button.ToolTip>
                        <StackPanel>
                            <TextBlock>
                                Publisher: Andrei - Euard Stan
                            </TextBlock>
                            <TextBlock>
                                Version: 1.4
                            </TextBlock>
                            <TextBlock>Organisation: Fuller Smith and Turner</TextBlock>
                            <TextBlock>License &amp; Disclaimer © 2025 Andrei - Eduard Stan. All rights reserved. Use only within the organization.</TextBlock>
                        </StackPanel>
                    </Button.ToolTip>
                </Button>
                <Button
                    Grid.Column="2"
                    Margin="0,0,15,0"
                    HorizontalAlignment="Right"
                    Background="Transparent"
                    BorderThickness="0"
                    Click="CloseApp"
                    Content="✖"
                    Foreground="White"
                    Template="{StaticResource NoMouseOverButtonTemplate}" />
            </Grid>

            <!--  Page 1: Selection Screen  -->
            <Grid
                x:Name="SelectionPage"
                Grid.Row="1"
                Visibility="Visible">

                <!--  Grid Layout  -->
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="3*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1*" />
                    <ColumnDefinition Width="1*" />
                </Grid.ColumnDefinitions>

                <!--  Logo & Title  -->
                <Image
                    Grid.Row="0"
                    Grid.ColumnSpan="2"
                    Height="80"
                    VerticalAlignment="Center"
                    Source="data/fullers-logo.png" />
                <TextBlock
                    Grid.Row="1"
                    Grid.ColumnSpan="2"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    FontSize="24"
                    FontWeight="DemiBold"
                    Foreground="White"
                    Text="Silent Installer"
                    TextAlignment="Center" />

                <!--  Carousel Container  -->
                <Grid
                    Grid.Row="2"
                    Grid.Column="0"
                    Margin="10,5,10,5">
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="2*" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <TextBlock
                        Grid.Row="0"
                        Grid.ColumnSpan="3"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontSize="24"
                        FontWeight="DemiBold"
                        Foreground="White"
                        Text="Select Setup Type:" />
                    <Button
                        Grid.Row="1"
                        Grid.Column="0"
                        Width="40"
                        Height="40"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Center"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="PreviousCategory_Click"
                        Content="◀"
                        FontSize="24"
                        Foreground="White"
                        RenderTransformOrigin="0.5,0.5"
                        Template="{StaticResource NoMouseOverButtonTemplate}">
                        <Button.Resources>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="1" ScaleY="1" />
                                    </Setter.Value>
                                </Setter>

                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <!--  Add any actions you want to perform on mouse over here  -->
                                        <Trigger.EnterActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation
                                                        Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                        To="1.2"
                                                        Duration="0:0:0.1" />
                                                    <DoubleAnimation
                                                        Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                        To="1.2"
                                                        Duration="0:0:0.1" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.EnterActions>
                                        <Trigger.ExitActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation
                                                        Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                        To="1"
                                                        Duration="0:0:0.1" />
                                                    <DoubleAnimation
                                                        Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                        To="1"
                                                        Duration="0:0:0.1" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.ExitActions>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Resources>
                    </Button>
                    <Grid Grid.Row="1" Grid.Column="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="2*" />
                            <RowDefinition Height="1*" />
                        </Grid.RowDefinitions>
                        <!--  Category Image  -->
                        <Image
                            x:Name="CategoryImage"
                            Grid.Row="0"
                            MaxWidth="150"
                            MaxHeight="150"
                            Margin="0,10,0,10"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Stretch="Uniform" />

                        <!--  Category Title  -->
                        <TextBlock
                            x:Name="CategoryTitle"
                            Grid.Row="1"
                            Width="Auto"
                            HorizontalAlignment="Center"
                            FontSize="18"
                            FontWeight="Bold"
                            Foreground="White"
                            TextAlignment="Center"
                            TextWrapping="Wrap" />
                    </Grid>

                    <Button
                        Grid.Row="1"
                        Grid.Column="2"
                        Width="40"
                        Height="40"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="NextCategory_Click"
                        Content="▶"
                        FontSize="24"
                        Foreground="White"
                        RenderTransformOrigin="0.5,0.5"
                        Template="{StaticResource NoMouseOverButtonTemplate}">
                        <Button.Resources>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="1" ScaleY="1" />
                                    </Setter.Value>
                                </Setter>

                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <!--  Add any actions you want to perform on mouse over here  -->
                                        <Trigger.EnterActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation
                                                        Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                        To="1.2"
                                                        Duration="0:0:0.1" />
                                                    <DoubleAnimation
                                                        Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                        To="1.2"
                                                        Duration="0:0:0.1" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.EnterActions>
                                        <Trigger.ExitActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation
                                                        Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                        To="1"
                                                        Duration="0:0:0.1" />
                                                    <DoubleAnimation
                                                        Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                        To="1"
                                                        Duration="0:0:0.1" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.ExitActions>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Resources>
                    </Button>

                    <TextBlock
                        x:Name="CategoryDescription"
                        Grid.Row="3"
                        Grid.ColumnSpan="3"
                        Width="Auto"
                        Padding="25,0,25,0"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontSize="18"
                        Foreground="White"
                        TextAlignment="Center"
                        TextWrapping="Wrap" />
                </Grid>

                <!--  Included Apps  -->
                <Grid
                    x:Name="IncludedAppsList"
                    Grid.Row="2"
                    Grid.Column="1"
                    Margin="10,5,10,5">
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                        <ColumnDefinition />
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <TextBlock
                        Grid.Row="0"
                        Grid.ColumnSpan="5"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontSize="24"
                        FontWeight="DemiBold"
                        Foreground="White"
                        Text="Included Applications:" />
                    <Grid
                        x:Name="IncludedAppsGrid"
                        Grid.Row="1"
                        Grid.RowSpan="2"
                        Grid.ColumnSpan="5" />
                </Grid>
                <!--  UpdateDriver Button  -->
                <Button
                    Grid.Row="3"
                    Grid.Column="0"
                    Margin="2,2,0,2"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    Background="#00DDDDDD"
                    BorderBrush="Gray"
                    BorderThickness="0,1,1,0"
                    Click="UpdateDrivers_Click"
                    FontSize="16"
                    FontWeight="Bold"
                    Foreground="White"
                    RenderTransformOrigin="0.5,0.5">

                    <Button.Resources>
                        <Style TargetType="{x:Type Border}">
                            <Setter Property="CornerRadius" Value="0,0,0,0" />
                        </Style>

                        <Style TargetType="{x:Type Button}">
                            <Setter Property="RenderTransform">
                                <Setter.Value>
                                    <ScaleTransform ScaleX="1" ScaleY="1" />
                                </Setter.Value>
                            </Setter>

                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Trigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.15" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="Gray"
                                                    Duration="0:0:0.15" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>

                                    <Trigger.ExitActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="#00DDDDDD"
                                                    Duration="0:0:0.3" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.ExitActions>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Resources>

                    <Button.Template>
                        <StaticResource ResourceKey="NoMouseOverButtonTemplate" />
                    </Button.Template>

                    <Button.RenderTransform>
                        <ScaleTransform ScaleX="1" ScaleY="1" />
                    </Button.RenderTransform>
                    <TextBlock Text="Update Drivers" />
                </Button>
                <!--  Start Button  -->
                <Button
                    Grid.Row="3"
                    Grid.Column="1"
                    Margin="0,2,2,2"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    Background="#00DDDDDD"
                    BorderBrush="Gray"
                    BorderThickness="1,1,0,0"
                    Click="StartInstallation_Click"
                    FontSize="16"
                    FontWeight="Bold"
                    Foreground="White"
                    RenderTransformOrigin="0.5,0.5">

                    <Button.Resources>
                        <Style TargetType="{x:Type Border}">
                            <Setter Property="CornerRadius" Value="0,0,0,0" />
                        </Style>

                        <Style TargetType="{x:Type Button}">
                            <Setter Property="RenderTransform">
                                <Setter.Value>
                                    <ScaleTransform ScaleX="1" ScaleY="1" />
                                </Setter.Value>
                            </Setter>

                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Trigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.15" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="Gray"
                                                    Duration="0:0:0.15" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>

                                    <Trigger.ExitActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="#00DDDDDD"
                                                    Duration="0:0:0.3" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.ExitActions>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Resources>

                    <Button.Template>
                        <StaticResource ResourceKey="NoMouseOverButtonTemplate" />
                    </Button.Template>

                    <Button.RenderTransform>
                        <ScaleTransform ScaleX="1" ScaleY="1" />
                    </Button.RenderTransform>
                    <TextBlock Text="Start" />
                </Button>

            </Grid>

            <!--  Page 2: Installation Progress  -->
            <Grid
                x:Name="InstallationPage"
                Grid.Row="1"
                Grid.ColumnSpan="3"
                Visibility="Hidden">
                <!--  Grid Layout  -->
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="0.5*" />
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>

                <!--  Logo & Title  -->
                <Image
                    Grid.Row="0"
                    Grid.ColumnSpan="2"
                    Height="80"
                    VerticalAlignment="Center"
                    Source="data/fullers-logo.png" />
                <TextBlock
                    Grid.Row="1"
                    Grid.ColumnSpan="2"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    FontSize="24"
                    FontWeight="DemiBold"
                    Foreground="White"
                    Text="Silent Installer"
                    TextAlignment="Center" />


                <!--  Progress Bar  -->
                <mah:ProgressRing
                    Grid.Row="3"
                    Grid.ColumnSpan="2"
                    Foreground="White"
                    IsActive="True" />

                <!--  Status Message  -->
                <TextBlock
                    x:Name="CurrentAppText"
                    Grid.Row="2"
                    Grid.ColumnSpan="2"
                    VerticalAlignment="Center"
                    FontSize="14"
                    Foreground="White"
                    TextAlignment="Center" />

                <!--  Log Output  -->
                <Border
                    Grid.Row="4"
                    Grid.ColumnSpan="2"
                    Width="400"
                    Height="100"
                    BorderBrush="White"
                    BorderThickness="1,1,1,1"
                    CornerRadius="8">
                    <TextBox
                        x:Name="OutputLogBox"
                        Width="360"
                        Height="90"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Background="Transparent"
                        BorderThickness="0"
                        FontSize="14px"
                        Foreground="White"
                        TextAlignment="Left"
                        TextWrapping="NoWrap" />
                </Border>
                <!--  Abort Button  -->
                <Button
                    Grid.Row="5"
                    Grid.ColumnSpan="2"
                    Height="83.0191666666666"
                    Margin="2,0,2,0"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch"
                    Background="Transparent"
                    BorderBrush="Gray"
                    BorderThickness="0,1,0,0"
                    Click="AbortInstallation_Click"
                    Content="Abort"
                    FontSize="16"
                    FontWeight="Bold"
                    Foreground="White"
                    RenderTransformOrigin="0.5,0.5">
                    <Button.Resources>
                        <Style TargetType="{x:Type Border}">
                            <Setter Property="CornerRadius" Value="0,0,0,0" />
                        </Style>

                        <Style TargetType="{x:Type Button}">
                            <Setter Property="RenderTransform">
                                <Setter.Value>
                                    <ScaleTransform ScaleX="1" ScaleY="1" />
                                </Setter.Value>
                            </Setter>

                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Trigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.15" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="Gray"
                                                    Duration="0:0:0.15" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>

                                    <Trigger.ExitActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="#00DDDDDD"
                                                    Duration="0:0:0.3" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.ExitActions>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Resources>

                    <Button.Template>
                        <StaticResource ResourceKey="NoMouseOverButtonTemplate" />
                    </Button.Template>

                    <Button.RenderTransform>
                        <ScaleTransform ScaleX="1" ScaleY="1" />
                    </Button.RenderTransform>
                </Button>
            </Grid>

            <!--  Page 3: Completion Screen  -->
            <Grid
                x:Name="CompletionPage"
                Grid.Row="1"
                Visibility="Collapsed">

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="2*" />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>

                <!--  Logo & Title  -->
                <Image
                    Grid.Row="0"
                    Grid.ColumnSpan="2"
                    Height="80"
                    VerticalAlignment="Center"
                    Source="data/fullers-logo.png" />
                <TextBlock
                    Grid.Row="1"
                    Grid.ColumnSpan="2"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    FontSize="24"
                    FontWeight="DemiBold"
                    Foreground="White"
                    Text="Silent Installer"
                    TextAlignment="Center" />
                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>
                    <Image
                        Grid.Column="0"
                        Height="80"
                        Margin="60"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Source="/data/checkicon.png" />
                    <TextBlock
                        Grid.Column="1"
                        VerticalAlignment="Center"
                        FontSize="30"
                        Foreground="White"
                        Text="Installation Successful"
                        TextAlignment="Left"
                        TextWrapping="Wrap" />
                </Grid>
                <!--  Included Apps  -->
                <Grid
                    Grid.Row="2"
                    Grid.Column="1"
                    Margin="10,5,10,5">
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                        <RowDefinition />

                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                        <ColumnDefinition />
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <TextBlock
                        Grid.Row="0"
                        Grid.ColumnSpan="5"
                        Margin="0,0,0,15"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        FontSize="24"
                        FontWeight="DemiBold"
                        Foreground="White"
                        Text="Installed Applications:" />
                    <Grid
                        x:Name="InstalledAppsGrid"
                        Grid.Row="1"
                        Grid.RowSpan="2"
                        Grid.ColumnSpan="5" />
                </Grid>
                <Button
                    Grid.Row="4"
                    Grid.Column="0"
                    Height="83.0191666666666"
                    Margin="2,0,0,2"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Bottom"
                    Background="Transparent"
                    BorderBrush="Gray"
                    BorderThickness="0,1,1,0"
                    Click="RestartButton_Click"
                    Content="Restart"
                    FontSize="16"
                    FontWeight="Bold"
                    Foreground="White"
                    RenderTransformOrigin="0.5,0.5">
                    <Button.Resources>
                        <Style TargetType="{x:Type Border}">
                            <Setter Property="CornerRadius" Value="0,0,0,0" />
                        </Style>

                        <Style TargetType="{x:Type Button}">
                            <Setter Property="RenderTransform">
                                <Setter.Value>
                                    <ScaleTransform ScaleX="1" ScaleY="1" />
                                </Setter.Value>
                            </Setter>

                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Trigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.15" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="Gray"
                                                    Duration="0:0:0.15" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>

                                    <Trigger.ExitActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="#00DDDDDD"
                                                    Duration="0:0:0.3" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.ExitActions>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Resources>

                    <Button.Template>
                        <StaticResource ResourceKey="NoMouseOverButtonTemplate" />
                    </Button.Template>

                    <Button.RenderTransform>
                        <ScaleTransform ScaleX="1" ScaleY="1" />
                    </Button.RenderTransform>
                </Button>

                <Button
                    Grid.Row="4"
                    Grid.Column="1"
                    Height="83.0191666666666"
                    Margin="0,0,2,2"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Bottom"
                    Background="Transparent"
                    BorderBrush="Gray"
                    BorderThickness="1,1,0,0"
                    Click="GoBack_Click"
                    Content="No Restart"
                    FontSize="16"
                    FontWeight="Bold"
                    Foreground="White"
                    RenderTransformOrigin="0.5,0.5">
                    <Button.Resources>
                        <Style TargetType="{x:Type Border}">
                            <Setter Property="CornerRadius" Value="0,0,0,0" />
                        </Style>

                        <Style TargetType="{x:Type Button}">
                            <Setter Property="RenderTransform">
                                <Setter.Value>
                                    <ScaleTransform ScaleX="1" ScaleY="1" />
                                </Setter.Value>
                            </Setter>

                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Trigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.15" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="Gray"
                                                    Duration="0:0:0.15" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>

                                    <Trigger.ExitActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="#00DDDDDD"
                                                    Duration="0:0:0.3" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.ExitActions>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Resources>

                    <Button.Template>
                        <StaticResource ResourceKey="NoMouseOverButtonTemplate" />
                    </Button.Template>

                    <Button.RenderTransform>
                        <ScaleTransform ScaleX="1" ScaleY="1" />
                    </Button.RenderTransform>
                </Button>
            </Grid>
            <!--  Page 3: Completion Screen  -->
            <Grid
                x:Name="AbortPage"
                Grid.Row="1"
                Visibility="Hidden">

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="2*" />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>

                <!--  Logo & Title  -->
                <Image
                    Grid.Row="0"
                    Grid.ColumnSpan="2"
                    Height="80"
                    VerticalAlignment="Center"
                    Source="data/fullers-logo.png" />
                <TextBlock
                    Grid.Row="1"
                    Grid.ColumnSpan="2"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    FontSize="24"
                    FontWeight="DemiBold"
                    Foreground="White"
                    Text="Silent Installer"
                    TextAlignment="Center" />
                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>
                    <Image
                        Grid.Column="0"
                        Height="80"
                        Margin="60"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Source="/data/cancelledicon.png" />
                    <TextBlock
                        Grid.Column="1"
                        VerticalAlignment="Center"
                        FontSize="30"
                        Foreground="White"
                        Text="Installation Aborted"
                        TextAlignment="Left"
                        TextWrapping="Wrap" />
                </Grid>
                <Button
                    Grid.Row="4"
                    Grid.Column="0"
                    Height="83.0191666666666"
                    Margin="2,0,0,2"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Bottom"
                    Background="Transparent"
                    BorderBrush="Gray"
                    BorderThickness="0,1,1,0"
                    Click="RestartButton_Click"
                    Content="Restart"
                    FontSize="16"
                    FontWeight="Bold"
                    Foreground="White"
                    RenderTransformOrigin="0.5,0.5">
                    <Button.Resources>
                        <Style TargetType="{x:Type Border}">
                            <Setter Property="CornerRadius" Value="0,0,0,0" />
                        </Style>

                        <Style TargetType="{x:Type Button}">
                            <Setter Property="RenderTransform">
                                <Setter.Value>
                                    <ScaleTransform ScaleX="1" ScaleY="1" />
                                </Setter.Value>
                            </Setter>

                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Trigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.15" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="Gray"
                                                    Duration="0:0:0.15" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>

                                    <Trigger.ExitActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="#00DDDDDD"
                                                    Duration="0:0:0.3" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.ExitActions>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Resources>

                    <Button.Template>
                        <StaticResource ResourceKey="NoMouseOverButtonTemplate" />
                    </Button.Template>

                    <Button.RenderTransform>
                        <ScaleTransform ScaleX="1" ScaleY="1" />
                    </Button.RenderTransform>
                </Button>

                <Button
                    Grid.Row="4"
                    Grid.Column="1"
                    Height="83.0191666666666"
                    Margin="0,0,2,2"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Bottom"
                    Background="Transparent"
                    BorderBrush="Gray"
                    BorderThickness="1,1,0,0"
                    Click="GoBack_Click"
                    Content="No Restart"
                    FontSize="16"
                    FontWeight="Bold"
                    Foreground="White"
                    RenderTransformOrigin="0.5,0.5">
                    <Button.Resources>
                        <Style TargetType="{x:Type Border}">
                            <Setter Property="CornerRadius" Value="0,0,0,0" />
                        </Style>

                        <Style TargetType="{x:Type Button}">
                            <Setter Property="RenderTransform">
                                <Setter.Value>
                                    <ScaleTransform ScaleX="1" ScaleY="1" />
                                </Setter.Value>
                            </Setter>

                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Trigger.EnterActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.15" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="Gray"
                                                    Duration="0:0:0.15" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.EnterActions>

                                    <Trigger.ExitActions>
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Background).(SolidColorBrush.Color)"
                                                    To="#00DDDDDD"
                                                    Duration="0:0:0.3" />
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Control.Foreground).(SolidColorBrush.Color)"
                                                    To="White"
                                                    Duration="0:0:0.3" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </Trigger.ExitActions>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Resources>

                    <Button.Template>
                        <StaticResource ResourceKey="NoMouseOverButtonTemplate" />
                    </Button.Template>

                    <Button.RenderTransform>
                        <ScaleTransform ScaleX="1" ScaleY="1" />
                    </Button.RenderTransform>
                </Button>
            </Grid>
        </Grid>
    </Grid>
</mah:MetroWindow>
